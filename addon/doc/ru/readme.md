# Лупа Windows #

* Автор: Cyrille Bougot
* Совместимость с NVDA: 2019.2.1 и выше
* Загрузить [стабильную версию][1]

Это дополнение улучшает использование Лупы Windows с NVDA.


## Возможности

* Позволяет отображать результат выполнения некоторых встроенных в лупу
  клавиатурных команд.
* Позволяет уменьшить количество случаев, когда команды навигации по таблице
  конфликтуют с командами лупы.
* Добавляет несколько сочетаний клавиш для переключения различных встроенных
  параметров Лупы.
* Позволяет сохранять и восстанавливать параметры конфигурации лупы.
* Добавляет некоторые дополнительные функции, которые не предоставляются
  лупой Windows (мышь для просмотра, окно лупы не сверху)

## Настройки

Панель настроек дополнения лупы Windows позволяет настроить реакцию NVDA на
собственные команды лупы Windows.  Возможно, вам захочется, чтобы в
зависимости от того, что вы видите, отображалось больше или меньше команд.
Панель также содержит опцию для изменения поведения окна управления лупой
Windows.

Эту панель можно открыть, выбрав Параметры -> Настройки в меню NVDA, а затем выбрав категорию лупы Windows в окне настроек.
Сочетание клавиш NVDA+Windows+O, затем O также позволяет напрямую открыть эту панель настроек.

Панель содержит следующие параметры:

* Сообщать о перемещениях представления: управляет отображением при
  перемещении представления с помощью команд Control+Alt+стрелки. Возможны
  три варианта:
  
    * Отключено: Ничего не сообщать.
    * С помощью речи: речевое сообщение указывает положение увеличенного
      масштаба в том измерении, в котором он перемещается.
    * С помощью сигналов: воспроизводится звуковой сигнал, высота которого
      указывает на положение увеличенного масштаба в том измерении, в
      котором оно перемещается.
  
  Этот параметр не влияет на режим закрепленного просмотра.

* Объявлять области экрана: управляет отображением, когда вы достигаете
  краев экрана при перемещении экрана с помощью команд Control+Alt+
  стрелки.  Доступны три варианта отображения: Выключено, с речью и
  звуковыми сигналами.  Этот вариант не влияет на режим закрепленного
  просмотра.
* Громкость звуковых сигналов, сообщающих о положении вида: позволяет
  определить громкость звуковых сигналов, если вы выбрали сообщать о
  перемещениях вида или краях экрана с помощью звуковых сигналов.
* Сообщать о включении или выключении: если этот флажок установлен,
  отображается информация о состоянии лупы, когда вы используете команды
  Windows++ или Windows+Escape для ее включения или выключения.
* Сообщать о масштабировании: если этот флажок установлен, при использовании
  команд Windows++ или Windows+- отображается информация об уровне
  масштабирования лупы.
* Сообщать об инверсии цвета: Если этот флажок установлен, то при
  использовании команды переключения control+Alt+I отображается информация о
  состоянии инверсии цвета.
* Сообщать об изменении вида: Если этот флажок установлен, отображается
  сообщение о типе вида при использовании команды, которая изменяет тип вида
  (Control+Alt+M, Control+Alt+F, Control+Alt+D, Control+Alt+L)
* Сообщать об изменении размера линзы или закрепленного окна: если этот
  флажок установлен, при использовании команд изменения размера
  (Alt+Shift+стрелки) выводится сообщение.  В режиме закрепленного окна
  отображается информация о высоте или ширине.  В режиме линзы пока
  невозможно сообщить о новом размере.  Похоже, что эти команды изменения
  размера доступны не во всех версиях Windows; если ваша версия Windows их
  не поддерживает, вам следует снять флажок с этой опции.
* В документах и списковых представлениях используйте сочетания клавиш
  control+alt+стрелки для Windows Magnifier: есть три возможных варианта:
  
    * Никогда: команда не передаётся в лупу Windows, и стандартная навигация
      по таблицам NVDA может работать.  При использовании в документах из
      таблицы команда Control+Alt+Стрелка выдаёт сообщение об ошибке "Вне
      таблице".  Это стандартное поведение NVDA без этого дополнения.  Вы
      по-прежнему можете использовать сочетания клавиш NVDA+Windows+O, затем
      стрелки для перемещения увеличенного изображения.
    * Команды Control+Alt+Стрелка выполняют стандартную навигацию по
      таблице, только если они не находятся в таблице: в виде таблицы или
      списка.  При использовании в документах вне таблицы команды
      Control+Alt+стрелка выполняют стандартные команды перемещения в режиме
      лупы.  Если вы все еще хотите переместить окно лупы Windows в режиме
      таблицы или списка, вам нужно будет нажать NVDA+F2 перед
      использованием команд Control+Alt+ стрелка или поочередно использовать
      NVDA+Windows+O, затем стрелки.  Этот вариант является наилучшим
      компромиссом, если вы хотите использовать Control+Alt+Стрелку как для
      навигации по лупе, так и по таблице.
    * Всегда: команды Control+Alt+стрелка перемещают вид лупы в любом
      случае.  Эта опция может быть полезна, если вы не используете клавиши
      Control+Alt+стрелка для навигации по таблице, например, потому что вы
      изменили сочетания клавиш навигации по таблицам в NVDA или потому что
      вы используете исключительно [Easy table navigator][5] для навигации
      по таблицам.

* Поместить командное окно Windows Magnifier поверх всех окон: если флажок
  снят, окно управления Лупой не будет всегда находиться поверх других окон.

## Команды, добавленные этим дополнением

В дополнение к встроенным командам Лупы, это дополнение предоставляет
дополнительные команды:

* Команды, позволяющие управлять параметрами Лупы, не открывая страницу его
  конфигурации.
* Дополнительные команды, специфичные для этого дополнения.

Все эти дополнительные команды доступны через команду уровня лупы
NVDA+Windows+O:

* NVDA+Windows+O then C: Toggles on or off caret tracking.
* NVDA+Windows+O then F: Toggles on or off focus tracking.
* NVDA+Windows+O then M: Toggles on or off mouse tracking.
* NVDA+Windows+O then T: Toggles on or off tracking globally.  When tracking
  is toggled on again, it is set to the last active tracking configuration
  before tracking was toggled off.
* NVDA+Windows+O then S: Toggles on or off smoothing.
* NVDA+Windows+O then R: Switches between mouse pointer tracking modes
  (within the edge of the screen or centered on the screen); this feature is
  only available on Windows 10 build 17643 or higher.
* NVDA+Windows+O then X: Switches between text cursor tracking modes (within
  the edge of the screen or centered on the screen); this feature is only
  available on Windows 10 build 18894 or higher.
* NVDA+Windows+O then shift+P: Saves the current configuration parameters of
  the magnifier to NVDA's configuration.
* NVDA+Windows+O then P: Restores the current configuration parameters of
  the magnifier from NVDA's configuration.  If no configuration parameters
  has been previously saved to NVDA's configuration, the default
  configuration parameters of Windows Magnifier are restored instead.
* NVDA+Windows+O then Arrows: Move the magnified view.
* NVDA+Windows+O then V: Moves the mouse cursor in the center of the
  magnified view (command not available in docked view mode).
* NVDA+Windows+O then W: Switches on or off the mode allowing to keep
  Windows Magnifier's control window always on top of the other ones.  This
  feature is only available for installed versions of NVDA.
* NVDA+Windows+O then O: Opens Windows Magnifier add-on settings.
* NVDA+Windows+O then H: Displays help on Magnifier layer commands.

Для каждой команды нет прямого жеста по умолчанию, но вы можете указать его
в обычном диалоге жестов ввода, если хотите.  Аналогичным образом вы также
можете изменить или удалить жест доступа к уровню лупы (NVDA+Windows+O).
Тем не менее, вы не можете изменить комбинацию клавиш для подкоманд уровня
лупы.


## Собственные команды лупы

Это дополнение может сообщать о результатах выполнения следующих собственных
команд лупы в соответствии с его конфигурацией:

* Start Magnifier: Windows++ (on alpha-numeric keyboard or on numpad)
* Quit Magnifier: Windows+Escape
* Zoom in: Windows++ (on alpha-numeric keyboard or on numpad)
* Zoom out: Windows+- (on alpha-numeric keyboard or on numpad)
* Toggle color inversion: Control+Alt+I
* Select the docked view: Control+Alt+D
* Select the full screen view: Control+Alt+F
* Select the lens view: Control+Alt+L
* Cycle through the three view types: Control+Alt+M
* Resize the lens with the keyboard: Shift+Alt+Left/Right/Up/DownArrow Note:
  although this does not seem to be documented, this shortcut seems to have
  been withdrawn in recent Windows versions such as Windows 10 2004.
* Move the magnified view: Control+Alt+Arrows

Here is also a list of other Magnifier native commands, just for
information:

* Control+Alt+mouseScrollWheel: Zooms in and out using the mouse scroll
  wheel.
* Control+Windows+M: Opens the Magnifier's settings window.
* Control+Alt+R: Resizes the lens with the mouse.
* Control+Alt+Space: Quickly shows the entire desktop when using full screen
  view.

Ни одна из собственных команд лупы не может быть изменена.


## Примечания

* На компьютерах, оснащённых графической картой Intel, клавиши
  control+alt+стрелка (влево/вправо/вверх/вниз) также используются для
  изменения ориентации экрана.  Эти сочетания клавиш включены по умолчанию и
  конфликтуют с сочетаниями клавиш лупы Windows для перемещения
  изображения.  Чтобы использовать их в качестве лупы, вам нужно будет
  отключить их.  Их можно отключить в панели управления Intel или в меню
  Intel, расположенном на системном лотке.
* В зависимости от вашей версии Windows, сочетание клавиш Alt +Shift +
  Стрелка - это сочетания клавиш лупы Windows для изменения масштаба (линзы
  или закреплённого).  Когда лупа активна (даже в полноэкранном режиме), эти
  сочетания клавиш фиксируются Magnifier и не могут быть переданы
  приложению, даже если вы нажмете NVDA+F2 до этого.  Чтобы использовать эти
  сочетания клавиш в текущем приложении, вам нужно закрыть лупу
  (Windows+Escape) и снова открыть ее (Windows++).  Например, в MS Word,
  чтобы уменьшить масштаб заголовка:
  
    * Нажмите Windows+Escape, чтобы выйти из Лупы.
    * Press Alt+Shift+RightArrow to decrease current title level.
    * Нажмите Windows++, чтобы снова открыть лупу.

* Для получения дополнительной информации о функциях и горячих клавишах Лупы
  Windows вы можете ознакомиться со следующими страницами:

    * [Использовать лупу, чтобы лучше видеть изображение на
      экране](https://support.microsoft.com/en-us/help/11542/windows-use-magnifier-to-make-things-easier-to-see)
    * [Сочетания клавиш Windows для обеспечения специальных возможностей][4]

* Это дополнение не тестировалось в многоэкранной среде, и есть вероятность,
  что некоторые функции в этой среде не работают.  Если вы используете
  многоэкранную среду и хотите, чтобы она поддерживалась, пожалуйста,
  свяжитесь со мной, чтобы я внедрил ее.
* В более общем плане, не стесняйтесь обращаться ко мне на [страницу
  GitHub][3] этого дополнения или напрямую по электронной почте.


## Журнал изменений

### Версия 3.5

* Готовится к совместимости с NVDA 2024.1.
* Устраняет потенциальные проблемы безопасности, связанные с
  [GHSA-xg6w-23rw-39r8][8] при использовании дополнения со старыми версиями
  NVDA. Однако рекомендуется использовать NVDA 2023.3.3 или выше.
* Примечание: С этого момента обновления перевода больше не будут
  отображаться в журнале изменений.

### Версия 3.4

* Команда "переместить мышь для просмотра" снова работает
* Обновлены локализации.

### Версия 3.3

* Совместимость снижена до версии NVDA 2019.2.1 и выше.  Последними
  версиями, совместимыми с NVDA 2018.3, являются [3.2][7] (частично
  совместимое) и [1.1][6] (полностью совместимое).
* Исправлена ошибка на панели настроек в NVDA 2019.2.1.

### Версия 3.2

* Удален канал разработчика.
* Обновлены локализации.

### Версия 3.1

* Исправлена ошибка, из-за которой командное окно Лупы не восстанавливалось
  сверху.
* Исправлена ошибка, из-за которой дополнение не запускалось в NVDA
  2019.2.1.
* Обновлены локализации.

### Версия 3.0

* Нажатие кнопок масштабирования в окне лупы (с клавиатуры) теперь объявляет
  новый уровень масштабирования.
* Параметр, управляющий тем, всегда ли окно управления лупой остается
  открытым, теперь сохранен в конфигурации; это означает, что этот параметр
  запоминается при перезапуске NVDA и может быть включен или не включен в
  зависимости от активного профиля.
* Исправлена ошибка, приводившая к неожиданному отключению затемнения экрана
  при использовании команд "Переместить для просмотра" или "переместить
  вид".
* Настройка параметра AlwaysOnTop теперь будет выполняться также при
  изменении режима увеличения.
* Добавлена возможность сохранять и восстанавливать конфигурацию Лупы
  Windows в конфигурации NVDA.
* Совместимость с NVDA 2023.1.
* Уточнено, какой тип отслеживания будет повторно включен при повторном
  включении отслеживания.
* Обновлены локализации.

### Версия 2.0

* Вид можно перемещать с помощью стрелок, находясь на уровне лупы Windows.
* Возможность сохранять окно команд лупы всегда открытым или нет.
* Добавлена возможность "Сообщать о краях экрана".
* Настройка громкости звуковых сигналов при использовании команд перемещения
  изображения.
* В режиме линзы теперь поддерживаются объявления перемещений в режиме
  просмотра и команды мыши для просмотра.
* Совместимость с NVDA 2022.1.
* Исправлена ошибка, из-за которой иногда неправильно сообщалось, что Лупа
  не работала при вызове скрипта.
* Выпуск теперь выполняется благодаря действию на GitHub, а не с помощью
  AppVeyor.
* Обновлены локализации.

### Версия 1.1

* Добавлены локализации.

### Версия 1.0

* Первый выпуск.

[[!tag dev stable]]

[1]: https://www.nvaccess.org/addonStore/legacy?file=winmag

[3]: https://github.com/CyrilleB79/winMag

[4]: https://support.microsoft.com/en-us/help/13810

[5]: https://addons.nvda-project.org/addons/easyTableNavigator.en.html

[6]:
https://github.com/CyrilleB79/winMag/releases/download/V1.1/winMag-1.1.nvda-addon

[7]:
https://github.com/CyrilleB79/winMag/releases/download/V3.2/winMag-3.2.nvda-addon

[8]:
https://github.com/nvaccess/nvda/security/advisories/GHSA-xg6w-23rw-39r8#event-132994

# Лупа Windows #

* Автор: Cyrille Bougot
* Совместимость с NVDA: 2019.2.1 и выше
* Загрузить [стабильную версию][1]

Это дополнение улучшает использование Лупы Windows с NVDA.


## Возможности

* Позволяет отображать результат выполнения некоторых встроенных в лупу
  клавиатурных команд.
* Позволяет уменьшить количество случаев, когда команды навигации по таблице
  конфликтуют с командами лупы.
* Добавляет несколько сочетаний клавиш для переключения различных встроенных
  параметров Лупы.
* Позволяет сохранять и восстанавливать параметры конфигурации лупы.
* Добавляет некоторые дополнительные функции, которые не предоставляются
  лупой Windows (мышь для просмотра, окно лупы не сверху)

## Настройки

Панель настроек дополнения лупы Windows позволяет настроить реакцию NVDA на
собственные команды лупы Windows.  Возможно, вам захочется, чтобы в
зависимости от того, что вы видите, отображалось больше или меньше команд.
Панель также содержит опцию для изменения поведения окна управления лупой
Windows.

Эту панель можно открыть, выбрав Параметры -> Настройки в меню NVDA, а затем выбрав категорию лупы Windows в окне настроек.
Сочетание клавиш NVDA+Windows+O, затем O также позволяет напрямую открыть эту панель настроек.

Панель содержит следующие параметры:

* Сообщать о перемещениях представления: управляет отображением при
  перемещении представления с помощью команд Control+Alt+стрелки. Возможны
  три варианта:
  
    * Отключено: Ничего не сообщать.
    * С помощью речи: речевое сообщение указывает положение увеличенного
      масштаба в том измерении, в котором он перемещается.
    * С помощью сигналов: воспроизводится звуковой сигнал, высота которого
      указывает на положение увеличенного масштаба в том измерении, в
      котором оно перемещается.
  
  Этот параметр не влияет на режим закрепленного просмотра.

* Объявлять области экрана: управляет отображением, когда вы достигаете
  краев экрана при перемещении экрана с помощью команд Control+Alt+
  стрелки.  Доступны три варианта отображения: Выключено, с речью и
  звуковыми сигналами.  Этот вариант не влияет на режим закрепленного
  просмотра.
* Громкость звуковых сигналов, сообщающих о положении вида: позволяет
  определить громкость звуковых сигналов, если вы выбрали сообщать о
  перемещениях вида или краях экрана с помощью звуковых сигналов.
* Сообщать о включении или выключении: если этот флажок установлен,
  отображается информация о состоянии лупы, когда вы используете команды
  Windows++ или Windows+Escape для ее включения или выключения.
* Сообщать о масштабировании: если этот флажок установлен, при использовании
  команд Windows++ или Windows+- отображается информация об уровне
  масштабирования лупы.
* Сообщать об инверсии цвета: Если этот флажок установлен, то при
  использовании команды переключения control+Alt+I отображается информация о
  состоянии инверсии цвета.
* Сообщать об изменении вида: Если этот флажок установлен, отображается
  сообщение о типе вида при использовании команды, которая изменяет тип вида
  (Control+Alt+M, Control+Alt+F, Control+Alt+D, Control+Alt+L)
* Сообщать об изменении размера линзы или закрепленного окна: если этот
  флажок установлен, при использовании команд изменения размера
  (Alt+Shift+стрелки) выводится сообщение.  В режиме закрепленного окна
  отображается информация о высоте или ширине.  В режиме линзы пока
  невозможно сообщить о новом размере.  Похоже, что эти команды изменения
  размера доступны не во всех версиях Windows; если ваша версия Windows их
  не поддерживает, вам следует снять флажок с этой опции.
* В документах и списковых представлениях используйте сочетания клавиш
  control+alt+стрелки для Windows Magnifier: есть три возможных варианта:
  
    * Никогда: команда не передаётся в лупу Windows, и стандартная навигация
      по таблицам NVDA может работать.  При использовании в документах из
      таблицы команда Control+Alt+Стрелка выдаёт сообщение об ошибке "Вне
      таблице".  Это стандартное поведение NVDA без этого дополнения.  Вы
      по-прежнему можете использовать сочетания клавиш NVDA+Windows+O, затем
      стрелки для перемещения увеличенного изображения.
    * Команды Control+Alt+Стрелка выполняют стандартную навигацию по
      таблице, только если они не находятся в таблице: в виде таблицы или
      списка.  При использовании в документах вне таблицы команды
      Control+Alt+стрелка выполняют стандартные команды перемещения в режиме
      лупы.  Если вы все еще хотите переместить окно лупы Windows в режиме
      таблицы или списка, вам нужно будет нажать NVDA+F2 перед
      использованием команд Control+Alt+ стрелка или поочередно использовать
      NVDA+Windows+O, затем стрелки.  Этот вариант является наилучшим
      компромиссом, если вы хотите использовать Control+Alt+Стрелку как для
      навигации по лупе, так и по таблице.
    * Всегда: команды Control+Alt+стрелка перемещают вид лупы в любом
      случае.  Эта опция может быть полезна, если вы не используете клавиши
      Control+Alt+стрелка для навигации по таблице, например, потому что вы
      изменили сочетания клавиш навигации по таблицам в NVDA или потому что
      вы используете исключительно [Easy table navigator][5] для навигации
      по таблицам.

* Поместить командное окно Windows Magnifier поверх всех окон: если флажок
  снят, окно управления Лупой не будет всегда находиться поверх других окон.

## Команды, добавленные этим дополнением

В дополнение к встроенным командам Лупы, это дополнение предоставляет
дополнительные команды:

* Команды, позволяющие управлять параметрами Лупы, не открывая страницу его
  конфигурации.
* Дополнительные команды, специфичные для этого дополнения.

Все эти дополнительные команды доступны через команду уровня лупы
NVDA+Windows+O:

* NVDA+Windows+O, затем C: переключает отслеживание курсора.
* NVDA+Windows+O, затем F: переключает отслеживание фокуса.
* NVDA+Windows+O, затем M: переключает отслеживание мыши.
* NVDA+Windows+O, затем T: глобальное включение или выключение
  отслеживания.  При повторном включении отслеживания устанавливается
  последняя активная конфигурация отслеживания перед отключением
  отслеживания.
* NVDA+Windows+O, затем S: переключает сглаживание.
* NVDA+Windows+O, затем R: переключение между режимами отслеживания
  указателя мыши (по краю экрана или по центру экрана); эта функция доступна
  только в Windows 10 сборки 17643 или выше.
* NVDA+Windows+O, затем X: переключение между режимами отслеживания
  текстового курсора (по краю экрана или по центру экрана); эта функция
  доступна только в Windows 10 сборки 18894 или выше.
* NVDA+Windows+O, затем Shift+P: сохраняет текущие параметры конфигурации
  лупы в конфигурации NVDA.
* NVDA+Windows+O, затем P: Восстанавливает текущие параметры конфигурации
  лупы из конфигурации NVDA.  Если никакие параметры конфигурации ранее не
  были сохранены в конфигурации NVDA, вместо этого восстанавливаются
  параметры конфигурации по умолчанию для Windows Magnifier.
* NVDA+Windows+O, затем Стрелки: перемещение увеличенного изображения.
* NVDA+Windows+O, затем V: перемещает курсор мыши в центр увеличенного
  изображения (команда недоступна в режиме закреплённого изображения).
* NVDA+Windows+O, затем W: Переключает режим, позволяющий всегда держать
  окно управления лупы Windows поверх других.  Эта функция доступна только
  для установленных версий NVDA.
* NVDA+Windows+O, затем O: открывает настройки дополнения Лупы Windows.
* NVDA+Windows+O, затем H: отображает справку по командам уровня лупы.

Для каждой команды нет прямого жеста по умолчанию, но вы можете указать его
в обычном диалоге жестов ввода, если хотите.  Аналогичным образом вы также
можете изменить или удалить жест доступа к уровню лупы (NVDA+Windows+O).
Тем не менее, вы не можете изменить комбинацию клавиш для подкоманд уровня
лупы.


## Собственные команды лупы

Это дополнение может сообщать о результатах выполнения следующих собственных
команд лупы в соответствии с его конфигурацией:

* Запустить лупу: Windows++ (на буквенно-цифровой клавиатуре или цифровой
  клавиатуре)
* Выйти из лупы: Windows+Escape
* Увеличить масштаб: Windows++ (на буквенно-цифровой клавиатуре или цифровой
  клавиатуре)
* Уменьшить масштаб: Windows+- (на буквенно-цифровой клавиатуре или цифровой
  клавиатуре)
* Переключить инверсию цвета: Control+Alt+I
* Выбрать закреплённый вид: Control+Alt+D
* Выбрать полноэкранный режим: Control+Alt+F
* Выбрать вид линзы: Control+Alt+L
* Переключаться между тремя типами представления: Control+Alt+M
* Изменить размер линзы с помощью клавиатуры: Shift+Alt+стрелки
  Влево/Вправо/Вверх/Вниз. Примечание: хотя это, похоже, не
  задокументировано, этот ярлык, похоже, был убран из последних версий
  Windows, таких как Windows 10 2004.
* Перемещение увеличенного изображения: Control+Alt+Стрелки

Вот также список других собственных команд лупы, просто для информации:

* Control+Alt+колесо прокрутки мыши: увеличение и уменьшение масштаба с
  помощью колеса прокрутки мыши.
* Control+Windows+M: Открывает окно настроек лупы.
* Control+Alt+R: Изменяет размер линзы с помощью мыши.
* Control+Alt+Пробел: Быстро отображает весь рабочий стол при использовании
  полноэкранного режима.

Ни одна из собственных команд лупы не может быть изменена.


## Примечания

* На компьютерах, оснащённых графической картой Intel, клавиши
  control+alt+стрелка (влево/вправо/вверх/вниз) также используются для
  изменения ориентации экрана.  Эти сочетания клавиш включены по умолчанию и
  конфликтуют с сочетаниями клавиш лупы Windows для перемещения
  изображения.  Чтобы использовать их в качестве лупы, вам нужно будет
  отключить их.  Их можно отключить в панели управления Intel или в меню
  Intel, расположенном на системном лотке.
* В зависимости от вашей версии Windows, сочетание клавиш Alt +Shift +
  Стрелка - это сочетания клавиш лупы Windows для изменения масштаба (линзы
  или закреплённого).  Когда лупа активна (даже в полноэкранном режиме), эти
  сочетания клавиш фиксируются Magnifier и не могут быть переданы
  приложению, даже если вы нажмете NVDA+F2 до этого.  Чтобы использовать эти
  сочетания клавиш в текущем приложении, вам нужно закрыть лупу
  (Windows+Escape) и снова открыть ее (Windows++).  Например, в MS Word,
  чтобы уменьшить масштаб заголовка:
  
    * Нажмите Windows+Escape, чтобы выйти из Лупы.
    * Нажмите Alt+Shift+Стрелка вправо, чтобы уменьшить текущий уровень
      заголовка.
    * Нажмите Windows++, чтобы снова открыть лупу.

* Для получения дополнительной информации о функциях и горячих клавишах Лупы
  Windows вы можете ознакомиться со следующими страницами:

    * [Использовать лупу, чтобы лучше видеть изображение на
      экране](https://support.microsoft.com/en-us/help/11542/windows-use-magnifier-to-make-things-easier-to-see)
    * [Сочетания клавиш Windows для обеспечения специальных возможностей][4]

* Это дополнение не тестировалось в многоэкранной среде, и есть вероятность,
  что некоторые функции в этой среде не работают.  Если вы используете
  многоэкранную среду и хотите, чтобы она поддерживалась, пожалуйста,
  свяжитесь со мной, чтобы я внедрил ее.
* В более общем плане, не стесняйтесь обращаться ко мне на [страницу
  GitHub][3] этого дополнения или напрямую по электронной почте.


## Журнал изменений

### Версия 3.5

* Готовится к совместимости с NVDA 2024.1.
* Устраняет потенциальные проблемы безопасности, связанные с
  [GHSA-xg6w-23rw-39r8][8] при использовании дополнения со старыми версиями
  NVDA. Однако рекомендуется использовать NVDA 2023.3.3 или выше.
* Примечание: С этого момента обновления перевода больше не будут
  отображаться в журнале изменений.

### Версия 3.4

* Команда "переместить мышь для просмотра" снова работает
* Обновлены локализации.

### Версия 3.3

* Совместимость снижена до версии NVDA 2019.2.1 и выше.  Последними
  версиями, совместимыми с NVDA 2018.3, являются [3.2][7] (частично
  совместимое) и [1.1][6] (полностью совместимое).
* Исправлена ошибка на панели настроек в NVDA 2019.2.1.

### Версия 3.2

* Удален канал разработчика.
* Обновлены локализации.

### Версия 3.1

* Исправлена ошибка, из-за которой командное окно Лупы не восстанавливалось
  сверху.
* Исправлена ошибка, из-за которой дополнение не запускалось в NVDA
  2019.2.1.
* Обновлены локализации.

### Версия 3.0

* Нажатие кнопок масштабирования в окне лупы (с клавиатуры) теперь объявляет
  новый уровень масштабирования.
* Параметр, управляющий тем, всегда ли окно управления лупой остается
  открытым, теперь сохранен в конфигурации; это означает, что этот параметр
  запоминается при перезапуске NVDA и может быть включен или не включен в
  зависимости от активного профиля.
* Исправлена ошибка, приводившая к неожиданному отключению затемнения экрана
  при использовании команд "Переместить для просмотра" или "переместить
  вид".
* Настройка параметра AlwaysOnTop теперь будет выполняться также при
  изменении режима увеличения.
* Добавлена возможность сохранять и восстанавливать конфигурацию Лупы
  Windows в конфигурации NVDA.
* Совместимость с NVDA 2023.1.
* Уточнено, какой тип отслеживания будет повторно включен при повторном
  включении отслеживания.
* Обновлены локализации.

### Версия 2.0

* Вид можно перемещать с помощью стрелок, находясь на уровне лупы Windows.
* Возможность сохранять окно команд лупы всегда открытым или нет.
* Добавлена возможность "Сообщать о краях экрана".
* Настройка громкости звуковых сигналов при использовании команд перемещения
  изображения.
* В режиме линзы теперь поддерживаются объявления перемещений в режиме
  просмотра и команды мыши для просмотра.
* Совместимость с NVDA 2022.1.
* Исправлена ошибка, из-за которой иногда неправильно сообщалось, что Лупа
  не работала при вызове скрипта.
* Выпуск теперь выполняется благодаря действию на GitHub, а не с помощью
  AppVeyor.
* Обновлены локализации.

### Версия 1.1

* Добавлены локализации.

### Версия 1.0

* Первый выпуск.

[[!tag dev stable]]

[1]: https://www.nvaccess.org/addonStore/legacy?file=winmag

[3]: https://github.com/CyrilleB79/winMag

[4]: https://support.microsoft.com/en-us/help/13810

[5]: https://addons.nvda-project.org/addons/easyTableNavigator.en.html

[6]:
https://github.com/CyrilleB79/winMag/releases/download/V1.1/winMag-1.1.nvda-addon

[7]:
https://github.com/CyrilleB79/winMag/releases/download/V3.2/winMag-3.2.nvda-addon

[8]:
https://github.com/nvaccess/nvda/security/advisories/GHSA-xg6w-23rw-39r8#event-132994

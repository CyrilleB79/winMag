# Windows 放大镜增强插件 #

* 作者: Cyrille Bougot
* NVDA 兼容版本: 2018.3或更高
* 下载 [稳定版][1]
* 下载 [开发版][2]

此插件增强了 NVDA 使用 Windows 放大镜时的体验。


## 功能

* 允许读出某些放大镜原有快捷键的结果。
* 允许减少表格导航快捷键与放大镜快捷键的冲突。
* 添加一些键盘快捷键来切换各种放大镜选项。


## 设置

Windows 放大镜增强的插件设置面板允许配置 NVDA 如何对原生 Windows 放大镜命令做出响应。
您可能希望根据您能看到的内容读出更多或更少的命令。
可以通过在 NVDA 菜单中选择选项 -> 设置，然后在设置窗口中选择 Windows 放大镜类别来打开此面板。
键盘快捷键 NVDA+Windows+O,O 也允许直接打开此设置面板。

该面板包含以下选项：

* 读出试图移动：控制使用 Ctrl+Alt+光标命令移动视图时读出的内容。这三个选项是：
  
    * 关闭：不读出任何内容。
    * 语音：用语音在视图移动时提示视图缩放范围的位置。
    * 提示音：在视图移动时播放，且用音高提示视图缩放范围的位置。
  
 此选项仅影响全屏视图模式。
  
* 读出打开或关闭：如果选中，当您使用 Windows++ 或 Windows+ESC 命令打开或关闭放大镜时，将读出放大镜的状态。
* 读出缩放：如果选中，当您使用 Windows++ 或 Windows+- 缩放命令时会读出放大镜的缩放级别。
* 读出反色：如果选中，则在使用 Ctrl+Alt+I 切换命令时读出反色状态。
* 读出视图更改：如果选中，则在使用更改视图类型的命令（Ctrl+Alt+M、Ctrl+Alt+F、Ctrl+Alt+D、Ctrl+Alt+L）时读出视图类型
* 读出镜头或停靠窗口调整大小：如果选中，则在您使用调整大小命令（Alt+Shift+光标）时会读出一条消息。在停靠窗口模式下，读出高度或宽度。在镜头模式下，目前无法读出新维度。这些调整大小命令并非在所有版本的
  Windows 上都可用；如果您的 Windows 版本不支持，您不应选中此选项。
* 在文档和列表视图中，将Ctrl+alt+光标快捷键传递给 Windows 放大镜： 有三种选择：
  
    * 从不：命令不会传递到 Windows 放大镜，标准 NVDA
      表格导航可以运行。在表格外的文档中使用时，Ctrl+Alt+光标命令会读出“不在表格中”错误消息。这是没有此插件的 NVDA 的默认行为。
    * 仅当不在表格中时：在表格或列表视图中，Ctrl+Alt+光标命令执行标准表格导航。在表格外的文档中使用时，Ctrl+Alt+光标命令执行标准的放大镜视图移动命令。如果您仍想在表格或列表视图中移动
      Windows 放大镜视图，则需要在使用 Ctrl+Alt+光标命令之前按 NVDA+F2。如果您想将
      Ctrl+Alt+光标用于放大镜和表格导航，则此选项是最佳折衷方案。
    * 始终：Ctrl+Alt+光标命令在任何情况下都会移动放大镜的视图。如果您不使用
      Ctrl+Alt+光标在表格中导航，则此选项可能很有用，例如您在 NVDA 中更改了表格导航快捷键，或者您专门使用 [简单表格导航][5]
      插件进行表格导航。


## 此插件添加的命令

除了Windows
放大镜的基本命令之外，此插件还提供了额外的命令，允许在不打开其配置页面的情况下控制放大镜的选项。所有添加到控制放大镜选项的命令都可以通过放大镜层命令
NVDA+Windows+O 访问：

* NVDA+Windows+O,C:打开或关闭跟随文本光标。
* NVDA+Windows+O,F：打开或关闭跟随键盘焦点。
* NVDA+Windows+O,M：打开或关闭跟随鼠标指针。
* NVDA+Windows+O,T：打开或关闭全局跟随。
* NVDA+Windows+O,S：打开或关闭图像和文本的平滑边缘。
* NVDA+Windows+O,R：在保留鼠标指针模式之间切换，包括屏幕边缘内和在屏幕上居中（此功能仅适用于 Windows 10
  Build17643及以上版本）。
* NVDA+Windows+O,X：在保留文本光标模式之间切换，包括屏幕边缘内和在屏幕上居中（此功能仅适用于 Windows 10 build
  18894 及以上版本）。
* NVDA+Windows+O,V：将鼠标光标移动到放大视图的中心（该命令仅在全屏视图中可用）。
* NVDA+Windows+O,O：打开Windows 放大镜插件设置。
* NVDA+Windows+O,H：显示放大镜命令的帮助。

每个命令没有默认手势和快捷键，但如果需要，可以在“按键与首饰”对话框中正常设置一个。同样，您也可以修改或删除放大镜层访问快捷键（NVDA+Windows+O）。但是，不能修改放大镜图层子命令的快捷键。


## 放大镜的原有快捷键

根据您的设置，此插件会朗读以下放大镜原有快捷键按下时的状态信息：

* Windows 徽标键  + 加号 (+)：打开放大镜
* Windows 徽标键  + Esc：关闭放大镜
* Windows 徽标键  + 加号 (+)：当放大镜打开时，进行放大
* Windows 徽标键  + 减号 (-)：当放大镜打开时，进行缩小
* Ctrl + Alt + I：打开或关闭反色
* Ctrl + Alt + D：切换到停靠视图
* Ctrl + Alt + F：切换到全屏视图
* Ctrl + Alt + L：切换到镜头视图
* Ctrl + Alt + M：循环浏览视图
* 使用键盘调整镜头大小：Shift+Alt+上、下、左、右光标。注意：虽然这没有记录，但这个快捷键在最近的 Windows 版本（如 Windows
  10 版本 2004）中似乎已被取消。
* 移动放大视图：Ctrl+Alt+光标（读出仅影响全屏模式）

下面是其他放大镜原有快捷键的列表，仅供参考：

* Ctrl + Alt + 鼠标滚轮：使用鼠标滚轮放大和缩小。
* Windows 徽标键  + Ctrl + M：打开“放大镜”设置。
* Ctrl + Alt + R：使用鼠标调整镜头大小。
* Ctrl + Alt + 空格键：使用全屏视图时快速查看整个桌面。

您不能修改放大镜的原有快捷键。


## 注意

* 对于配备 Intel 显卡的计算机，Ctrl+Alt+光标键也是修改屏幕方向的快捷键。这些快捷键在默认情况下是启用的，并且与移动放大镜视图的
  Windows 快捷键冲突。您需要禁用它们才能将其用于放大镜。它们可以在 Intel 图形控制面板或系统托盘中的 Intel菜单中禁用。
* 在某些 Windows 版本，Alt+Shift+光标键是 Windows
  放大镜的快捷键，用于调整放大视图的大小（镜头或停靠）。当放大镜处于活动状态时，即使在全屏试图下，这些快捷键也将被放大镜捕获，并且不能传递给应用程序，即使您之前按了
  NVDA+F2。要在当前应用程序中使用这些快捷键，您需要退出放大镜（Windows+Esc），然后再重新打开它（Windows++）。例如在
  Word 中降低标题级别：
  
    * 按 Windows 徽标键  +Esc退出放大镜。
    * 按Alt+Shift+右光标键可降低当前标题级别。
    * 按 Windows 徽标键  + 加号 (+)重新打开放大镜。

* 有关Windows放大镜功能和快捷方式的详细信息，请参阅以下页面：

    * [使用“放大镜”可使屏幕上的内容更易于查看](https://support.microsoft.com/zh-cn/help/11542/windows-use-magnifier-to-make-things-easier-to-see)
    * [用于辅助功能的 Windows 键盘快捷方式][4]


## 更新日志

### 版本 1.0

* 发布初始版本。

[[!tag dev stable]]

[1]: https://addons.nvda-project.org/files/get.php?file=winmag

[2]: https://addons.nvda-project.org/files/get.php?file=winmag-dev

[4]: https://support.microsoft.com/zh-cn/help/13810

[5]: https://addons.nvda-project.org/addons/easyTableNavigator.zh_CN.html
